#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-commit hook simplificado para FisioFlow
echo "ğŸ” Executando verificaÃ§Ãµes pre-commit..."

# 1. Lint-staged (formataÃ§Ã£o e lint bÃ¡sico)
echo "ğŸ§¹ Executando lint-staged..."
npm run pre-commit

# 2. Verificar se hÃ¡ secrets/keys expostos (apenas em arquivos de cÃ³digo)
echo "ğŸ” Verificando por secrets expostos..."
if grep -r -i --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=dist --exclude-dir=build \
  --include="*.ts" --include="*.tsx" --include="*.js" --include="*.jsx" --include="*.env*" \
  -E "(api_key|secret|password|token)\s*=\s*['\"][a-zA-Z0-9]{16,}" . ; then
  echo "âŒ PossÃ­veis secrets detectados! Remova antes do commit."
  exit 1
fi

echo "âœ… VerificaÃ§Ãµes bÃ¡sicas concluÃ­das!"